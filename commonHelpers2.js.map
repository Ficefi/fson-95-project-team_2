{"version":3,"file":"commonHelpers2.js","sources":["../src/js/footer.js","../src/js/discount.js","../src/js/popular_products.js","../src/js/pagination.js"],"sourcesContent":["import { subscriptionModal } from \"./modal_window\";\n\nconst registerForm = document.querySelector(\".footer-form-authorization\");\n\nregisterForm.addEventListener(\"submit\", handleSubmit);\n\nfunction handleSubmit(event) {\n    event.preventDefault();\n    \n    subscriptionModal(registerForm[0].value);\n\n    registerForm.reset();\n}\n","import { getAllProducts, getCategoriesProducts, getDiscountProducts, getPopularProducts, getProductById, createNewOrder, sendSubscription } from \"./fetchAPI\"\nimport { openModal } from \"./modal_window\"\nimport  svgIcon  from '../img/icons.svg'\n// import { addToStorageCart, removeFromStorageCart, isExistInCart } from \"./localStorage\"\n\nconst card = document.querySelector('.card');\n// Ліміт карток на сторінці\nconst cardsPerPage = 2;\n\nfunction createMarkup(images, names, startIndex = 0) {\n  const endIndex = startIndex + cardsPerPage;\n  const slicedImages = images.slice(startIndex, endIndex);\n\n  const res = slicedImages.map(({ img, price, _id, desc }, index) =>\n    `<li class=\"card_item\" data-id=\"${_id}\">\n      <div class=\"discount-icon-container\">\n        <svg class=\"discount-icon\" width=\"60\" height=\"60\">\n          <use href=\"${svgIcon}#icon-discount\"></use>\n        </svg>\n      </div>\n      <div class=\"card-content\">\n        <img src=\"${img}\" alt=\"${desc}\" class=\"card-img\" width=\"105\" height=\"105\">\n      </div>\n      <div class=\"title-box\">\n        <h3 class=\"card-title\">${names[index]}</h3>\n        <p class=\"card-price\">$${price}</p>\n      </div>\n      <button class=\"basket\" data-id=\"${_id}\">\n        <svg class=\"basket-icon\" width=\"18\" height=\"18\">\n          <use href=\"${svgIcon}#icon-cart\"></use>\n        </svg>\n      </button>\n    </li>`\n  ).join('');\n  return res;\n};\n\nasync function addToBasket() {\n  const result = await getDiscountProducts();\n  const shortNames = result.reduce((acc, product) => {\n    if (product.name.length > 10) {\n      acc.push(product.name.slice(0, 10) + \"...\");\n    } else {\n      acc.push(product.name);\n    }\n    return acc;\n  }, []);\n\n  card.innerHTML = createMarkup(result, shortNames);\n\n  // Виклик модалки\n  card.addEventListener('click', (event) => {\n    const item = event.target.closest('.card_item');\n    if (item) {\n      const id = item.dataset.id;\n      openModal(id);\n    }\n  });\n\n\n  // Зміна кнопки\n  const btn = document.querySelectorAll('.basket');\n\n  btn.forEach((button) => {\n    button.addEventListener(\"click\", handleAddToCart);\n    const id = button.dataset.id;\n    if (isExistInCart(id)) {\n      button.setAttribute(\"disabled\", true);\n      button.innerHTML = `\n        <svg class=\"basket-icon-check\" width=\"18\" height=\"18\">\n          <use href=\"${svgIcon}#icon-check\"></use>\n        </svg>\n      `;\n    }\n  });\n}\naddToBasket();\n\nfunction handleAddToCart(e) {\n  const button = e.currentTarget;\n  const id = button.dataset.id;\n\n  if (button.hasAttribute(\"disabled\")) {\n    removeFromStorageCart(id)\n    button.removeAttribute(\"disabled\");\n    button.innerHTML = `\n      <svg class=\"basket-icon\" width=\"18\" height=\"18\">\n        <use href=\"${svgIcon}#icon-cart\"></use>\n      </svg>\n    `;\n  } else {\n    addToStorageCart(id)\n    button.setAttribute(\"disabled\", true);\n    button.innerHTML = `\n      <svg class=\"basket-icon-check\" width=\"18\" height=\"18\">\n        <use href=\"${svgIcon}#icon-check\"></use>\n      </svg>\n    `;\n  }\n}\n\n\n\n\n\nfunction addToStorageCart(productId) {\n  const currentCart = JSON.parse(localStorage.getItem('cart')) || [];\n\n  if (!currentCart.includes(productId)) {\n    currentCart.push(productId);\n\n    localStorage.setItem('cart', JSON.stringify(currentCart));\n  }\n}\n\n\nfunction removeFromStorageCart(productId) {\n  const currentCart = JSON.parse(localStorage.getItem('cart')) || [];\n\n  const index = currentCart.indexOf(productId);\n\n  if (index !== -1) {\n    currentCart.splice(index, 1);\n\n    localStorage.setItem('cart', JSON.stringify(currentCart));\n  }\n}\n\nfunction isExistInCart(productId) {\n  try {\n    const currentCart = JSON.parse(localStorage.getItem('cart')) || [];\n    return currentCart.includes(productId);\n  } catch (error) {\n    console.error('Помилка парсингу JSON:', error);\n    return false;\n  }\n}\n\n\n","import { getPopularProducts } from './fetchAPI';\nimport { openModal } from './modal_window';\nimport svg from '../img/icons.svg'\n\nconst product_list = document.querySelector('.product-card');\n\nfunction createPopularList() {\n  getPopularProducts()\n    .then(result => {\n      createPopularMarkup(result);\n    })\n    .catch(error => {\n      throw new Error(error);\n    });\n}\n\nfunction createPopularMarkup(array) {\n  const containerDiv = document.createElement('div');\n  containerDiv.classList.add('product-list-container');\n\n  const markup = array\n    .map(({ category, img, name, popularity, size, _id }) => {\n      return `<li class=\"product-content\" data-id=${_id}>\n        <div class=\"background-img\">\n            <img src=\"${img}\" alt=\"${name}\" class=\"product-image\" />\n        </div>\n        <div class=\"product-txt-bar\">\n            <h3 class=\"product-title\">${name}</h3>\n            <p class=\"product-category\">\n                <span class=\"span-category\">Category:</span>${String(\n                  category\n                ).replace(`_`, ` `)}\n            </p>\n            <div class=\"product-txt-two\">\n                <p class=\"product-size\">\n                    <span class=\"span-category\">Size:</span>${size}\n                </p>\n                <p class=\"product-popularity\">\n                    <span class=\"span-category\">Popularity:</span>${popularity}\n                </p>\n            </div>\n        </div>\n        <div class=\"svg-svg\">\n            <svg class=\"svg-item\" width=\"12\" height=\"12\">\n                <use href=\"${svg}#icon-cart\"></use>\n            </svg>\n        </div>\n    </li>`;\n    })\n    .join('');\n\n  containerDiv.innerHTML = markup;\n  product_list.appendChild(containerDiv);\n}\n\nfunction modalCall(event) {\n  const item = event.target.closest('.product-content');\n\n  if (item) {\n    const id = item.dataset.id;\n    openModal(id);\n  }\n}\n\nproduct_list.addEventListener('click', modalCall)\n\ncreatePopularList();\n\nexport { createPopularList };\n","import Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\nimport { getAllProducts, getProducts } from './fetchAPI';\nimport { createMarkup } from './renderFood';\n\nconst paginationContainer = document.querySelector('.pagination');\n\nlet visiblePages = 0;\n\nconst screenWidth = window.innerWidth;\nif (screenWidth <= 767) {\n  visiblePages = 2;\n} \nelse {\n  visiblePages = 4;\n}\n\nlet page = 1;\n\nfunction createPagination(data, visiblePages) {\n  const options = {\n    totalItems: data.totalPages * 10,\n    visiblePages: visiblePages,\n    template: {\n      page: '<a href=\"#\" id=\"page-btn\" class=\"tui-page-btn\">{{page}}</a>',\n      currentPage:\n        '<strong id=\"is-selected\" class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n      moveButton:\n        '<a href=\"#\" id=\"arrow-btn\" class=\"tui-page-btn tui-{{type}} custom-class-{{type}}\">' +\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n        '</a>',\n      disabledMoveButton:\n        '<span id=\"arrow-btn\" class=\"tui-page-btn tui-is-disabled tui-{{type}} custom-class-{{type}}\">' +\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n        '</span>',\n      moreButton:\n        '<a href=\"#\" id=\"page-btn\" class=\"tui-page-btn tui-{{type}}-is-ellip custom-class-{{type}}\">' +\n        '<span class=\"tui-ico-ellip\">...</span>' +\n        '</a>',\n    },\n  };\n\n  const pagination = new Pagination('pagination', options);\n\n  pagination.on('afterMove', function (eventData) {\n    page = eventData.page;\n    getProducts(page)\n      .then(foodArray => {\n        createMarkup(foodArray.results);\n      })\n      .catch(error => {\n        throw new Error(error);\n      });\n  });\n}\n\ngetProducts(page)\n  .then(data => {\n    createPagination(data, visiblePages);\n  })\n  .catch(error => {\n    throw new Error(error);\n  });\n\nexport { createPagination };\n\n\nfunction handleAddToCart(e) {\n  const button = e.currentTarget;\n  console.log(button);\n  const id = button.dataset.id;\n  console.log(id);\n\n  if (button.hasAttribute(\"disabled\")) {\n    removeFromStorageCart(id)\n    console.log(removeFromStorageCart(id));\n    button.removeAttribute(\"disabled\");\n    button.innerHTML = `\n      <svg class=\"basket-icon\" width=\"18\" height=\"18\">\n        <use href=\"../img/icons.svg#icon-cart\"></use>\n      </svg>\n    `;\n  } else {\n    addToStorageCart(id)\n    console.log(addToStorageCart(id));\n    button.setAttribute(\"disabled\", true);\n    button.innerHTML = `\n      <svg class=\"basket-icon-check\" width=\"18\" height=\"18\">\n        <use href=\"../img/icons.svg#icon-check\"></use>\n      </svg>\n    `;\n  }\n}\n\n\nconst btn = document.querySelectorAll('.svg-container');\nconsole.log(btn);\n\nbtn.forEach((button) => {\n  button.addEventListener(\"click\", handleAddToCart);\n  const id = button.dataset.id;\n  if (isExistInCart(id)) {\n    button.setAttribute(\"disabled\", true);\n    button.innerHTML = `\n      <svg class=\"basket-icon-check\" width=\"18\" height=\"18\">\n        <use href=\"../img/icons.svg#icon-check\"></use>\n      </svg>\n    `;\n  }\n});\n"],"names":["registerForm","handleSubmit","event","subscriptionModal","card","cardsPerPage","createMarkup","images","names","startIndex","endIndex","img","price","_id","desc","index","svgIcon","addToBasket","result","getDiscountProducts","shortNames","acc","product","item","id","openModal","button","handleAddToCart","isExistInCart","removeFromStorageCart","addToStorageCart","productId","currentCart","error","product_list","createPopularList","getPopularProducts","createPopularMarkup","array","containerDiv","markup","category","name","popularity","size","svg","modalCall","visiblePages","screenWidth","page","createPagination","data","options","Pagination","eventData","getProducts","foodArray","btn"],"mappings":"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"}