{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart.js"],"sourcesContent":["import { getProductById } from './fetchAPI.js';\nimport { addToStorageCart, removeFromStorageCart } from './localStorage.js';\nimport { orderSuccessModal } from './modal_window.js';\nimport { handleCartItem, qty_card_products } from './header.js';\nimport svg from '../img/icons.svg';\n\nconst selectors = {\n  cart: document.querySelector('.cart'),\n  basket_items: document.querySelector('.basket-items-cart'),\n  number_of_products: document.querySelector('.number-of-products'),\n  total_price: document.querySelector('.total-price'),\n  delete_all_btn: document.querySelector('.del-all-btn'),\n  order_total: document.querySelector('.order-total'),\n  cart_form_authorization: document.querySelector('.cart-form-authorization'),\n  cart_label_wrap: document.querySelector('.cart-label-wrap'),\n  qty_card: document.querySelector('.qty-card'),\n};\n// function displayCart() {\n//   let j = 0;\n//   document.getElementById(\n//     'card-counter'\n//   ).innerHTML = `<img class=\"basket-img\" src = \"../img/yellow-basket.png\" width = \"164px\" height = \"140px\" alt = \"Yellow shopping basket\" >\n// \t\t<h2 class=\"basket-title\">\n// \t\t\tYour basket is <span class=\"accent-txt\">empty...</span>\n// \t\t</h2>\n// \t\t<p class=\"basket-txt\">Go to the main page to select your favorite products and add them to the cart.</p>\n// `;\n// }\n\n///////////костилі///////////\nconst content = document.querySelectorAll('main');\nconst content1 = document.querySelectorAll('footer');\nconst content2 = document.querySelectorAll('header');\ncontent[1].style.display = 'none';\ncontent1[1].style.display = 'none';\ncontent2[1].style.display = 'none';\n\nconst cart = JSON.parse(localStorage.getItem('cart')) || [];\n\n\n//////////////// IF SOMETHING IN CART HIDE BASKET IMAGE///////////////\n\nif (cart.length > 0) {\n  selectors.cart.style.display = 'none';\n\n} else if (cart.length === 0) {\n  selectors.cart.style.display = 'flex';\n  selectors.basket_items.style.display = 'none';\n  selectors.delete_all_btn.style.display = 'none';\n  selectors.order_total.style.display = 'none';\n  selectors.cart_form_authorization.style.display = 'none';\n  selectors.cart_label_wrap.style.display = 'none';\n}\n\n///////////////NUMBER OF PRODUCTS IN CART///////////\nlet numberOfProducts = cart.length;\n\nselectors.number_of_products.textContent = String(numberOfProducts);\n\n//////////////TOTAL PRODUCTS PRICE//////////////////\nlet totalPrice = 0;\n\n///////////////ADD ONE ITEM BY ID///////////////\nasync function addItem(id) {\n  let itemPrice;\n  await getProductById(id).then(response => {\n    const { name, category, size, price, img, desc, _id } = response;\n    itemPrice = price;\n    const markup = `<li class='basket-item-cart' data-id='${_id}' data-price='${price}'>\n  <button class='remove-item' data-modal-close aria-label='delete button'>\n        <svg class='remove-item-image' width='20' height='20'>\n          <use href='${svg}#icon-close-btn'></use>\n        </svg>\n      </button>\n     <img class='product-img' src='${img}' alt='${desc}'>\n     <div class='prod-items-wrap'>\n     <h2 class='product-name'>${name}</h2>\n\t\t <div class='prod-desc'>\n\n     <p class='prod-value'><span class='product-category-cart'>Category:&nbsp;</span>${category.replace(\n      '_',\n      ' ',\n    ).replace('&', '').replace('_', ' ')}</p>\n     <p class='prod-value'><span class='product-category-cart'>Size:&nbsp;</span> ${size}</p>\n     </div>\n\t\t <p class='prod-price'>$${price}</p>\n     </div>\n\n     </li>\n     `;\n\n    selectors.basket_items.insertAdjacentHTML('beforeend', markup);\n  });\n  return itemPrice;\n}\n\nasync function addAllItem() {\n  for (const item of cart) {\n    if (!item) {\n    } else {\n      await addItem(item).then(price => totalPrice += price);\n    }\n  }\n}\n\n\naddAllItem().then(resp => {\n  selectors.total_price.textContent = '$' + totalPrice.toFixed(2);\n  //////////////////  SUBMIT FORM ////////////////\n\n  selectors.cart_form_authorization.addEventListener('submit', submitForm);\n\n  function submitForm(e) {\n    e.preventDefault();\n    orderSuccessModal();\n    selectors.cart_form_authorization.reset();\n    deleteAllFromBasket();\n    handleCartItem(0);\n    selectors.cart_form_authorization.removeEventListener('submit', submitForm)\n  }\n\n  /////////////// INCREMENT AND DECREMENT /////////////////\n\n\n  const incrementBtn = document.querySelector('.increment-button');\n  incrementBtn.addEventListener('click', handleIncrement);\n\n  function handleIncrement(event) {\n    console.log(event.target.closest('.basket-item-cart'));\n\n    const cartArray = JSON.parse(localStorage.getItem('cart'));\n\n\n    console.log(cartArray);\n  }\n\n});\n\n\nselectors.basket_items.addEventListener('click', handleRemove);\n\nfunction handleRemove(e) {\n  e.preventDefault();\n\n  if (e.target.className !== 'remove-item') {\n    return;\n  }\n\n  const number = selectors.qty_card.textContent;\n  selectors.qty_card.textContent = String(number - 1);\n\n  const item = e.target.closest('.basket-item-cart');\n\n  totalPrice = totalPrice - Number(item.dataset.price);\n\n  selectors.total_price.textContent = '$' + totalPrice.toFixed(2);\n\n  selectors.basket_items.removeChild(item);\n  removeFromStorageCart(item.dataset.id);\n\n\n  const cart = JSON.parse(localStorage.getItem('cart')) || [];\n  let numberOfProducts = cart.length;\n\n  selectors.number_of_products.textContent = String(numberOfProducts);\n\n}\n\n////////////DELETE ALL BUTTON LOGIC///////////\nselectors.delete_all_btn.addEventListener('click', deleteAllFromBasket);\n\nfunction deleteAllFromBasket() {\n  localStorage.removeItem('cart');\n  handleCartItem(0);\n  selectors.cart.style.display = 'flex';\n  selectors.basket_items.style.display = 'none';\n  selectors.delete_all_btn.style.display = 'none';\n  selectors.order_total.style.display = 'none';\n  selectors.cart_form_authorization.style.display = 'none';\n  selectors.cart_label_wrap.style.display = 'none';\n  selectors.basket_items.removeEventListener('click', handleRemove);\n}\n\n\n\n\n"],"names":["selectors","content","content1","content2","cart","numberOfProducts","totalPrice","addItem","id","itemPrice","getProductById","response","name","category","size","price","img","desc","_id","markup","svg","addAllItem","item","resp","submitForm","e","orderSuccessModal","deleteAllFromBasket","handleCartItem","handleIncrement","event","cartArray","handleRemove","number","removeFromStorageCart"],"mappings":"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"}