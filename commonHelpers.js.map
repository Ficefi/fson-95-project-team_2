{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart.js"],"sourcesContent":["import { getProductById } from './fetchAPI.js';\nimport { addToStorageCart, removeFromStorageCart } from './localStorage.js';\nimport { orderSuccessModal } from './modal_window.js';\nimport { handleCartItem, qty_card_products } from './header.js';\nimport svg from '../img/icons.svg';\n\nconst selectors = {\n  cart: document.querySelector('.cart'),\n  basket_items: document.querySelector('.basket-items-cart'),\n  number_of_products: document.querySelector('.number-of-products'),\n  total_price: document.querySelector('.total-price'),\n  delete_all_btn: document.querySelector('.del-all-btn'),\n  order_total: document.querySelector('.order-total'),\n  cart_form_authorization: document.querySelector('.cart-form-authorization'),\n  cart_label_wrap: document.querySelector('.cart-label-wrap'),\n  qty_card: document.querySelector('.qty-card'),\n};\n// function displayCart() {\n//   let j = 0;\n//   document.getElementById(\n//     'card-counter'\n//   ).innerHTML = `<img class=\"basket-img\" src = \"../img/yellow-basket.png\" width = \"164px\" height = \"140px\" alt = \"Yellow shopping basket\" >\n// \t\t<h2 class=\"basket-title\">\n// \t\t\tYour basket is <span class=\"accent-txt\">empty...</span>\n// \t\t</h2>\n// \t\t<p class=\"basket-txt\">Go to the main page to select your favorite products and add them to the cart.</p>\n// `;\n// }\n\n///////////костилі///////////\nconst content = document.querySelectorAll('main');\nconst content1 = document.querySelectorAll('footer');\nconst content2 = document.querySelectorAll('header');\n\n\ncontent[1].remove()\ncontent1[1].remove()\ncontent2[1].remove()\n\n\n\nconst cart = JSON.parse(localStorage.getItem('cart')) || [];\n\n\n\nfunction hideAll() {\n  selectors.cart.style.display = 'flex';\n  selectors.basket_items.style.display = 'none';\n  selectors.delete_all_btn.style.display = 'none';\n  selectors.order_total.style.display = 'none';\n  selectors.cart_form_authorization.style.display = 'none';\n  selectors.cart_label_wrap.style.display = 'none';\n}\n\n\n//////////////// IF SOMETHING IN CART HIDE BASKET IMAGE///////////////\n\nif (cart.length === 0) {\n  hideAll();\n} else {\n  selectors.cart.style.display = 'none';\n}\n\n///////////////NUMBER OF PRODUCTS IN CART///////////\nlet numberOfProducts = cart.length;\n\nselectors.number_of_products.textContent = String(numberOfProducts);\n\n//////////////TOTAL PRODUCTS PRICE//////////////////\nlet totalPrice = 0;\n\n///////////////ADD ONE ITEM BY ID///////////////\nasync function addItem(id) {\n  let itemPrice;\n  await getProductById(id).then(response => {\n    const { name, category, size, price, img, desc, _id } = response;\n    itemPrice = price;\n    const markup = `<li class='basket-item-cart' data-id='${_id}' data-price='${price}'>\n  <button class='remove-item' data-modal-close aria-label='delete button'>\n        <svg class='remove-item-image' width='20' height='20'>\n          <use href='${svg}#icon-close-btn'></use>\n        </svg>\n      </button>\n     <img class='product-img' src='${img}' alt='${desc}'>\n     <div class='prod-items-wrap'>\n     <h2 class='product-name'>${name}</h2>\n\t\t <div class='prod-desc'>\n\n     <p class='prod-value'><span class='product-category-cart'>Category:&nbsp;</span>${category.replace(\n      '_',\n      ' ',\n    ).replace('&', '').replace('_', ' ')}</p>\n     <p class='prod-value'><span class='product-category-cart'>Size:&nbsp;</span> ${size}</p>\n     </div>\n\t\t <p class='prod-price'>$${price}</p>\n     </div>\n\n     </li>\n     `;\n\n    selectors.basket_items.insertAdjacentHTML('beforeend', markup);\n  });\n  return itemPrice;\n}\n\nasync function addAllItem() {\n  for (const item of cart) {\n    if (!item) {\n    } else {\n      await addItem(item).then(price => totalPrice += price);\n    }\n  }\n}\n\n\naddAllItem().then(resp => {\n  selectors.total_price.textContent = '$' + totalPrice.toFixed(2);\n  //////////////////  SUBMIT FORM ////////////////\n\n  selectors.cart_form_authorization.addEventListener('submit', submitForm);\n\n  function submitForm(e) {\n    e.preventDefault();\n    orderSuccessModal();\n    selectors.cart_form_authorization.reset();\n    deleteAllFromBasket();\n    handleCartItem(0);\n    selectors.cart_form_authorization.removeEventListener('submit', submitForm)\n  }\n\n  /////////////// INCREMENT AND DECREMENT /////////////////\n\n\n  // const incrementBtn = document.querySelector('.increment-button');\n  // incrementBtn.addEventListener('click', handleIncrement);\n  //\n  // function handleIncrement(event) {\n  //   console.log(event.target.closest('.basket-item-cart'));\n  //\n  //   const cartArray = JSON.parse(localStorage.getItem('cart'));\n  //\n  //\n  //   console.log(cartArray);\n  // }\n\n});\n\n\nselectors.basket_items.addEventListener('click', handleRemove);\n\nfunction handleRemove(e) {\n  e.preventDefault();\n  const check = JSON.parse(localStorage.getItem('cart')) || [];\n  if (check.length === 1) {\n    hideAll();\n  }\n\n\n  if (e.target.className !== 'remove-item') {\n    return;\n  }\n\n\n\n\n\n\n  const number = selectors.qty_card.textContent;\n  selectors.qty_card.textContent = String(number - 1);\n\n  const item = e.target.closest('.basket-item-cart');\n\n  totalPrice = totalPrice - Number(item.dataset.price);\n\n  selectors.total_price.textContent = '$' + totalPrice.toFixed(2);\n\n  e.target.closest('.basket-item-cart').classList.add(\"slide-out-elliptic-left-bck\");\n function removeFromDom() {\n   selectors.basket_items.removeChild(item);\n }\n\n setTimeout(removeFromDom, 500)\n  removeFromStorageCart(item.dataset.id);\n\n\n  const cart = JSON.parse(localStorage.getItem('cart')) || [];\n  let numberOfProducts = cart.length;\n\n  selectors.number_of_products.textContent = String(numberOfProducts);\n\n\n\n}\n\n////////////DELETE ALL BUTTON LOGIC///////////\nselectors.delete_all_btn.addEventListener('click', deleteAllFromBasket);\n\nfunction deleteAllFromBasket() {\n  localStorage.removeItem('cart');\n  handleCartItem(0);\n  hideAll();\n  selectors.basket_items.removeEventListener('click', handleRemove);\n}\n\n\n\n\n"],"names":["selectors","content","content1","content2","cart","hideAll","numberOfProducts","totalPrice","addItem","id","itemPrice","getProductById","response","name","category","size","price","img","desc","_id","markup","svg","addAllItem","item","resp","submitForm","e","orderSuccessModal","deleteAllFromBasket","handleCartItem","handleRemove","number","removeFromDom","removeFromStorageCart"],"mappings":"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"}